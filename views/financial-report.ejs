<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Financial Report - TNSTC Finance Planner</title>
<link rel="stylesheet" href="/css/style.css">

<style>
.report-header { text-align:center; margin-bottom:2rem; }
.report-header h2 { font-size:1.5rem; color:#1a3c5e; font-weight:800; }
.date-selector-container {
  background:#fff; padding:1.5rem; border-radius:12px;
  box-shadow:0 4px 6px rgba(0,0,0,.05);
  max-width:400px; margin:0 auto 2.5rem;
  display:flex; gap:1rem; align-items:center;
}
.report-section { margin-top:3rem; }
.section-title {
  font-weight:800; color:#1a3c5e;
  border-bottom:2px solid #1a3c5e;
  padding-bottom:.5rem; margin-bottom:1.5rem;
  display:flex; justify-content:space-between;
}
.horizontal-table {
  width:100%; border-collapse:collapse; background:#fff;
  box-shadow:0 4px 6px rgba(0,0,0,.05);
}
.horizontal-table th, .horizontal-table td {
  padding:1rem; border:1px solid #e2e8f0; text-align:right;
}
.horizontal-table th:first-child,
.horizontal-table td:first-child {
  text-align:left; font-weight:700; background:#f8fafc;
}
.grand-total {
  text-align:right; font-size:1.2rem;
  font-weight:800; color:#1a3c5e; margin-top:1rem;
}
.split-section {
  display:grid; grid-template-columns:1fr 1fr;
  border:2px solid #1a3c5e; background:#fff;
}
.split-col { padding:1.5rem; }
.split-col:first-child { border-right:2px solid #1a3c5e; }
.split-header {
  text-align:center; font-weight:800;
  border-bottom:2px solid #1a3c5e;
  margin:-1.5rem -1.5rem 1.5rem;
  padding:.8rem; background:#f8fafc;
}
.data-row {
  display:flex; justify-content:space-between;
  margin-bottom:.8rem;
}
.data-row.highlight {
  margin-top:1.5rem; border-top:1px solid #e2e8f0;
  padding-top:1rem; font-weight:800;
}
</style>
</head>

<body>

<nav class="sidebar">
  <div class="sidebar-header"><h2>TNSTC Finance</h2></div>
  <ul class="sidebar-menu">
    <li><a href="/">Dashboard</a></li>
    <li><a href="/bank-balances">Bank Balances</a></li>
    <li><a href="/daily-collections">Daily Collections</a></li>
    <li><a href="/payment-planning">Payment Planning</a></li>
    <li><a href="/hsd-management">HSD Management</a></li>
    <li><a href="/financial-report" class="active">Financial Report</a></li>
  </ul>
</nav>

<div class="main-content">
<header>
  <h1>Financial Report</h1>
  <p class="date-range">Finance Position Analysis</p>
</header>

<main class="container">

<div class="report-header">
  <h2>TNSTC KUMBAKONAM â€“ FINANCE POSITION</h2>
</div>

<div class="date-selector-container">
  <label>Position Date</label>
  <input type="date" value="<%= positionDate %>"
         onchange="location.href='?positionDate='+this.value">
</div>

<!-- ================= BANK BALANCES ================= -->
<section class="report-section">
<div class="section-title">
  BANK BALANCES <span>(Rs. in Crores)</span>
</div>

<table class="horizontal-table">
<thead>
<tr>
  <th>Bank</th>
  <% bankData.forEach(b => { %>
    <th><%= b.name %></th>
  <% }) %>
</tr>
</thead>

<tbody>
<tr>
  <td>Balance</td>
  <% 
    let bankTotal = 0;
    bankData.forEach(b => {
      bankTotal += b.balance;
  %>
    <td><%= (b.balance / 10000000).toFixed(2) %></td>
  <% }) %>
</tr>
</tbody>
</table>

<div class="grand-total">
  Total : <%= (bankTotal / 10000000).toFixed(2) %>
</div>
</section>

<!-- ================= COLLECTION / EXPENSES ================= -->
<section class="report-section">
<div class="section-title">
  COLLECTION / EXPENSES <span>(Rs. in Lakhs)</span>
</div>

<div class="split-section">

<div class="split-col">
<div class="split-header">COLLECTION</div>
<div class="data-row"><span>Collection</span>
<span><%= collectionInfo ? (collectionInfo.grossCollection/100000).toFixed(2) : '0.00' %></span></div>
<div class="data-row"><span>Less 11%</span>
<span><%= collectionInfo ? (collectionInfo.batta/100000).toFixed(2) : '0.00' %></span></div>
<div class="data-row"><span>POS</span>
<span><%= collectionInfo ? (collectionInfo.posCharges/100000).toFixed(2) : '0.00' %></span></div>
<div class="data-row highlight"><span>Net</span>
<span><%= collectionInfo ? (collectionInfo.netCollection/100000).toFixed(2) : '0.00' %></span></div>
</div>

<div class="split-col">
<div class="split-header">EXPENSES</div>
<div class="data-row"><span>Oil</span>
<span><%= (expenseInfo.oilExp/100000).toFixed(2) %></span></div>
<div class="data-row"><span>Other</span>
<span><%= (expenseInfo.otherExp/100000).toFixed(2) %></span></div>
<div class="data-row highlight"><span>Total</span>
<span><%= (expenseInfo.totalExp/100000).toFixed(2) %></span></div>
</div>

</div>
</section>

<!-- ================= PAYMENTS ================= -->
<section class="report-section">
<div class="section-title">
  PAYMENTS <span>(Rs. in Lakhs)</span>
</div>

<div class="split-section">

<div class="split-col">
<div class="split-header">OTHER PAYMENTS</div>
<% if(otherPaymentsList.length){ %>
  <% otherPaymentsList.forEach(p => { %>
    <div class="data-row"><span><%= p.subCategory %></span>
    <span><%= (p.amount/100000).toFixed(2) %></span></div>
  <% }) %>
<% } else { %>
  <div class="data-row">No Other Payments</div>
<% } %>
</div>

<div class="split-col">
<div class="split-header">HSD PAYMENTS</div>
<% hsdPaymentsList.forEach(p => { %>
  <div class="data-row"><span><%= p.name %></span>
  <span><%= (p.amount/100000).toFixed(2) %></span></div>
<% }) %>
</div>

</div>
</section>

</main>
</div>

</body>
</html>